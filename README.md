# Wildberries Media Bot

Telegram –±–æ—Ç –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–æ—Ç–æ –∏ –≤–∏–¥–µ–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å Wildberries –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É –∏–ª–∏ —Å—Å—ã–ª–∫–µ.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì∑ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Ç–æ–≤–∞—Ä–æ–≤ (–¥–æ 10 —à—Ç –∑–∞ —Ä–∞–∑)
- üé• –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ —Ç–æ–≤–∞—Ä–æ–≤
- üîó –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏ —Å—Å—ã–ª–æ–∫ Wildberries
- ‚ö° –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- üìä –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
- ‚ùå –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.10+**
- **aiogram 3** - async Telegram Bot framework
- **aiohttp** - async HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ WB API
- **pydantic** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone <your-repo-url>
cd MPCabinet_Picture_Bot
```

### 2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

### 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:

```env
BOT_TOKEN=your_bot_token_from_botfather
LOG_LEVEL=INFO
WB_API_TIMEOUT=10
WB_RATE_LIMIT_DELAY=0.2
MAX_RETRIES=3
```

### 5. –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

1. –ù–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º (—É–∫–∞–∂–∏—Ç–µ –∏–º—è –∏ username –±–æ—Ç–∞)
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ `.env`

## –ó–∞–ø—É—Å–∫

```bash
python main.py
```

–í—ã —É–≤–∏–¥–∏—Ç–µ:

```
Bot starting...
Log level: INFO
WB API timeout: 10s
WB rate limit delay: 0.2s
Starting long polling...
```

–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω! –ù–∞–π–¥–∏—Ç–µ –µ–≥–æ –≤ Telegram –ø–æ username –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –∞—Ä—Ç–∏–∫—É–ª –∏–ª–∏ —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä:
   - `12345678`
   - `https://www.wildberries.ru/catalog/12345678/detail.aspx`

2. –í—ã–±–µ—Ä–∏—Ç–µ —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å:
   - üì∑ –§–æ—Ç–æ
   - üé• –í–∏–¥–µ–æ
   - üì∑ + üé• –í—Å—ë

3. –ü–æ–ª—É—á–∏—Ç–µ —Ñ–∞–π–ª—ã!

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
MPCabinet_Picture_Bot/
‚îÇ
‚îú‚îÄ‚îÄ main.py                      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ settings.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Pydantic
‚îÇ
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ start.py            # /start, /help
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ article.py          # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤/—Å—Å—ã–ª–æ–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ callbacks.py        # –û–±—Ä–∞–±–æ—Ç–∫–∞ inline –∫–Ω–æ–ø–æ–∫
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ inline.py           # Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ middlewares/
‚îÇ       ‚îî‚îÄ‚îÄ error_handler.py    # –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ wb_parser.py            # –ü–∞—Ä—Å–∏–Ω–≥ –ø—É–±–ª–∏—á–Ω–æ–≥–æ API WB
‚îÇ   ‚îî‚îÄ‚îÄ media_downloader.py     # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞
‚îÇ
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ validators.py           # –í–∞–ª–∏–¥–∞—Ü–∏—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤/—Å—Å—ã–ª–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ logger.py               # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ exceptions.py           # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îÇ
‚îî‚îÄ‚îÄ tests/                      # Unit-—Ç–µ—Å—Ç—ã
```

## API Wildberries

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ø—É–±–ª–∏—á–Ω–æ–µ API** Wildberries –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ–≤–∞—Ä–∞—Ö:

- **Endpoint**: `https://card.wb.ru/cards/v1/detail?nm={–∞—Ä—Ç–∏–∫—É–ª}`
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- **Rate Limiting**: ~10-20 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ (–Ω–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ)

### –§–æ—Ä–º—É–ª—ã URL –º–µ–¥–∏–∞

**–§–æ—Ç–æ:**
```
https://basket-{basket}.wbbasket.ru/vol{vol}/part{part}/{nmId}/images/big/{N}.webp
```

**–í–∏–¥–µ–æ:**
```
https://video.wildberries.ru/{nmId}/{nmId}.mp4
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest tests/ -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest tests/ --cov=. --cov-report=term-missing
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `bot.log` –∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:

```
2026-01-19 15:00:00,123 - __main__ - INFO - Bot starting...
2026-01-19 15:00:01,456 - wb_parser - INFO - Fetching product 12345678
2026-01-19 15:00:02,789 - wb_parser - INFO - Product found: –¢–æ–≤–∞—Ä –Ω–∞–∑–≤–∞–Ω–∏–µ
2026-01-19 15:00:05,012 - media_downloader - INFO - Sending 5 photos to chat 123456
```

## Troubleshooting

### –û—à–∏–±–∫–∞: "Failed to load settings"

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª `.env` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç `BOT_TOKEN`.

### –û—à–∏–±–∫–∞: "WB API error"

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –í–æ–∑–º–æ–∂–Ω–æ, Wildberries –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å `WB_API_TIMEOUT` –≤ `.env`

### –û—à–∏–±–∫–∞: "Timeout connecting to Wildberries"

–£–≤–µ–ª–∏—á—å—Ç–µ `WB_API_TIMEOUT` –∏ `MAX_RETRIES` –≤ `.env`.

### –í–∏–¥–µ–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

–í–∏–¥–µ–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ 20 MB (–ª–∏–º–∏—Ç Telegram –¥–ª—è URL upload). –≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ Telegram API.

## –õ–∏–º–∏—Ç—ã

### Telegram Bot API:
- –§–æ—Ç–æ: –¥–æ 5 MB (URL), 10 MB (multipart)
- –í–∏–¥–µ–æ: –¥–æ 20 MB (URL), 50 MB (multipart)
- sendMediaGroup: 2-10 —Ñ–∞–π–ª–æ–≤ –∑–∞ —Ä–∞–∑

### Wildberries API:
- Rate limit –Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 10-20 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏: –≤—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π handler –≤ `bot/handlers/`
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ router –≤ `main.py`
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã –≤ `tests/`

### –ö–æ–¥ —Å—Ç–∏–ª—å

- PEP 8
- Type hints
- Docstrings –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

- GitHub: [–≤–∞—à GitHub]
- Telegram: [@–≤–∞—à_username]

## –î–∏—Å–∫–ª–µ–π–º–µ—Ä

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–µ API Wildberries. –ê–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è API –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –¥–æ—Å—Ç—É–ø–∞.

# Инструкции для Claude

## Язык общения

**Всегда отвечай на русском языке** во всех сообщениях, комментариях к коду и документации.

## Правило ответов в чате

Будь лаконичен. Не пиши в чате фрагменты кода. Экономим токены. Только минимально необходимые сведения для принятия решений

## Правило commit

После каждого полного изменения кода делай commit с информацией на русском языке

## Правило версионирования (SemVer)

Придерживаемся Semantic Versioning 2.0.0 (semver.org):

### Когда увеличивать версию

- **MAJOR** (X.0.0): Breaking changes
  - Несовместимые изменения API бота
  - Изменение формата команд
  - Удаление функциональности

- **MINOR** (0.X.0): Новая функциональность (обратно совместимая)
  - Добавление новых возможностей (кеширование, HLS конвертация)
  - Значительные улучшения производительности
  - Новые команды/функции бота

- **PATCH** (0.0.X): Исправления багов и мелкие улучшения
  - Bug fixes
  - Обновление зависимостей
  - Рефакторинг без изменения поведения
  - Накопленные косметические изменения UI

### Что НЕ требует версионирования

- Косметические изменения текста сообщений
- Улучшения документации
- Исправления опечаток
- Изменения комментариев в коде

Такие изменения накапливаются в commits и включаются в следующий PATCH/MINOR релиз.

### Процесс релиза

**MAJOR/MINOR релизы:**
1. Обновить VERSION файл
2. Обновить всю документацию (README, CONTEXT.md, docs/PLAN.md)
3. Создать git tag `vX.Y.Z`
4. Сделать GitHub release

**PATCH релизы:**
1. Обновить VERSION файл
2. Обновить затронутые секции документации
3. Обновить PLAN.md (добавить в историю)
4. Опционально: git tag для важных PATCH

Текущая версия хранится в `VERSION` файле.

## Правило ошибок и качества

1. Если видишь ошибки в коде, то сразу предлагай исправлять. Игнорировать ошибки запрещено

2. **Качество важнее скорости:**
   - Commit делается ТОЛЬКО когда ВСЕ тесты проходят (не "большинство", а 100%)
   - Каждая итерация должна оставлять проект в полностью рабочем состоянии
   - Если нашёл проблему (например, падающие тесты) - исправь её полностью, не принимай частичные решения
   - Лучше потратить больше времени на проверку, чем закоммитить нерабочий код
   - Рефакторинг не должен ломать существующий функционал - всегда проверяй через тесты

## Правило плана

**ВАЖНО:** Все планы мы храним ТОЛЬКО в файле `docs/PLAN.md`.

### Работа с планами

**При входе в Plan mode:**

1. Система может создавать временные планы в `.claude/plans/` - это нормально
2. Прочитай `docs/PLAN.md` для понимания текущего контекста проекта
3. Работай с временным планом во время планирования

**После выхода из Plan mode:**

1. **ОБЯЗАТЕЛЬНО** синхронизируй временный план → `docs/PLAN.md`
2. Добавь временную метку `**Обновлено:** ДД.ММ.ГГГГ ЧЧ:ММ`
3. Обнови секцию "Текущая версия" и "Текущая фаза"
4. Сохрани важные детали реализации (критические файлы, архитектура)
5. Отмечай выполненные этапы чекбоксами [x]

**Во время реализации:**

1. Следуй плану из `docs/PLAN.md`
2. Обновляй `docs/PLAN.md` после завершения этапов
3. Добавляй актуальные статусы задач

### Документация

- Справочник WB API: `docs/wb-api/README.md`
- Промпты для разработки: `docs/wb-api/PROMPTS.md`

## Запрещённые API

**card.wb.ru** — запрещено предлагать к использованию. Этот API не работает. Бот получает медиа только через CDN wbbasket.ru.

## Команды управления ботом (Git Bash)

```bash
# Остановить бота
taskkill //F //IM python.exe 2>/dev/null || true

# Проверить статус бота
tasklist | grep -i python && echo "Бот работает" || echo "Бот остановлен"

# Запустить бота (в фоне)
cd /c/Users/SFran/Documents/GitHub/MPCabinet_Picture_Bot && python main.py &

# Читать логи (последние 50 строк)
tail -50 /c/Users/SFran/Documents/GitHub/MPCabinet_Picture_Bot/bot.log

# Читать логи в реальном времени
tail -50f /c/Users/SFran/Documents/GitHub/MPCabinet_Picture_Bot/bot.log
```

## Правило внесения изменений в код

В код вносятся только утвержденные изменения. Если по ходу внесения изменений в код появляется необходимость что-то изменить еще, то каждое такое изменение согласовывается с пользователем.

## Философия разработки

Разработка через тестирование (Test-driven development, TDD)
